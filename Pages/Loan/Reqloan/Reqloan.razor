@page "/ws_lon_reqloan";
@using Newtonsoft.Json
@using Radzen.Blazor
@using System.Runtime.InteropServices.JavaScript
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.JSInterop
@inject IJSRuntime jsRuntime
@inject HttpClient httpClient
@using System.Linq.Dynamic.Core
@inject NotificationService NotificationService
@using System.Globalization
@using System.Text.Json
@* @using System.ComponentModel
@using System.ComponentModel.DataAnnotations *@
@using System.Text;

<style>
    .icon-search {
        display: inline-flex !important;
        justify-content: space-evenly !important;
        align-items: center !important;
        position: relative !important;
        top: 3px !important;
        padding: 15px !important;
        flex-wrap: nowrap !important;
    }

    .table> :not(caption)>*>* {
        padding: 0.2rem 0.2rem;
    }

    .save_top {
        border: #adacac solid 1px;
    }

    .header-right {
        text-align: start;
    }

    .header-left {
        text-align: end;
    }

    .rz-calendar .rz-inputtext {
        background-color: #e9ecef;
        opacity: 1;
    }

    .rz-fileupload-row {
        display: flex;
        color: transparent;
        align-items: center;
        justify-content: space-between;
        flex-direction: column-reverse;
    }

    .rz-fileupload-row img {
        width: 250px;
        max-width: 250px;
        margin-top: -4rem;
        max-height: 200px;
    }

    .rz-fileupload-row button {
        margin-left: 20rem;
        margin-top: 8px;
    }

    .rz-fileupload-files {
        background-color: var(--rz-upload-files-background-color);
        padding: var(--rz-upload-files-padding);
        margin-top: -1.5rem;
    }

    .rz-fileupload-buttonbar {
        position: relative;
        background-color: transparent;
        padding: var(--rz-upload-button-bar-padding);
        border-radius: var(--rz-upload-button-bar-border-radius);
    }

    .rz-card.rz-variant-filled {
        box-shadow: var(--rz-base-background-color);
        margin-top: -5px;
    }

    .rz-card {
        padding: 0;
        box-sizing: var(--rz-base-background-color);
    }

    .card {
        background-color: #f9f9f9;
    }

    tr:hover td {
        background-color: transparent;
    }

    td {
        text-align: left;
        padding: 2px;
    }

    .cashiput {
        color: #00CC00;
        background-color: black;
        text-align: right;
        font-size: 16px;
        font-weight: bold;
        width: 100%;
    }

    .cashiput::placeholder {
        color: #00CC00;
        /* สีที่คุณต้องการ */
    }

    .cashred::placeholder {
        color: red;
        /* สีที่คุณต้องการ */
    }

    .label-group {
        margin-left: 10px;
    }

    .my-element {
        margin-bottom: 10px;
        margin-top: 10px;
    }
</style>

<div class="header-page">
    <div class="row-header d-flex justify-content-between ">
        <div class="header-left">
            <h4>ขอกู้เงินสามัญ</h4>
        </div>
    </div>
</div>

<div class="card body-page">
    <div class="row mt-2"
        style="margin-left: calc(var(--bs-gutter-x) * .0);margin-right: calc(var(--bs-gutter-x) * .1);margin-bottom: 15px; padding: 0px;">

        @if (datalists == null)
        {
            <div class="row">
                <div class="col-xl-3 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">เลขที่ใบขอกู้</label>
                    <div class="input-group">
                        <input type="text" @bind="@searchTerm" class="form-control" Name="deptaccount_no" />
                    </div>
                </div>
                <div class="col-xl-2 col-md-6 col-sm-6 d-flex flex-column" style="margin-top: 45px;">
                    <button class="btn btn-outline-secondary" @onclick="SearchOfGet">
                        ค้นหา
                    </button>
                </div>
            </div>
        }

        else
        {
            @foreach (var item in datalists)
            {
                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">เลขสมาชิก</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.coop_id" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">เลขพนักงาน</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.member_no" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">ชื่อ-นามสกุล</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.fullname" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">ตำแหน่ง</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.membtype_desc" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">ตำแหน่ง</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.membgroup_desc" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">วันที่ขอสินเชื่อ</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.loanrequest_date" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">วันเกิด</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.birth_date" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">วันที่เป็นสมาชิก</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.member_date" />
                    </div>
                </div>

                <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                    <label class="form-label my-element" for="">รายการอายุสมาชิก</label>
                    <div class="input-group">
                        <input type="text" class="form-control" Name="deptaccount_no" @bind="@item.member_ageshow" />
                    </div>
                </div>


                <div class="row" hidden>
                    <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                        <label class="form-label my-element" for="">วันที่ผ่านรายการ</label>
                        <RadzenDatePicker @bind-Value=@posted_date Name="posted_date" DateFormat="dd/MM/yyyy" />
                    </div>

                    <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                        <label class="form-label my-element" for="">ประเภทเงินกู้</label>
                        <select class="form-select" name="" id="" style="text-align:left;">
                            <option value="1">กรุณาเลือก</option>
                            <option value="1"> 01 - (01) เงินกู้สามัญ - ปกติ</option>
                            <option value="2"> 03 - (03) เงินกู้สามัญ - ปกติ(ทุนเรือนหุ้นค้ำชำระรายเดือน) </option>
                            <option value="3"> 04 - (04) เงินกู้สามัญ - ปกติ(เงินฝากค้ำชำระรายเดือน) </option>
                            <option value="4"> 05 - (05) เงินกู้สามัญ - ปกติ(เงินฝากค้ำหักดอกเบี้ย) </option>
                            <option value="5"> 06 - (06) เงินกู้สามัญ - ปกติ(คำนวณโบนัส) </option>
                            <option value="6"> 07 - (07) เงินกู้สามัญ - ปกติ(คำนวณโบนัส คำนวณโอที) </option>
                            <option value="7"> 08 - (08) เงินกู้สามัญ - ปรับปรุงโครงสร้างหนี้ </option>
                            <option value="8"> 09 - (09) เงินกู้สามัญ - เพื่อชำระหนี้แทน </option>
                            <option value="9"> 21 - (21) เงินกู้ฉุกเฉิน </option>
                            <option value="10"> 22 - (22) เงินกู้ฉุกเฉินผ่าน ATM </option>
                            <option value="11"> 2A - (2A) เงินกู้ฉุกเฉิน(คำนวณโอที) </option>
                            <option value="12"> 2B - (2B) เงินกู้ฉุกเฉินผ่าน ATM (คำนวณโอที) </option>
                            <option value="13"> 2C - (2C) เงินกู้ฉุกเฉินโครงการสวัสดิการกู้เพือเหตุฉุกเฉิน </option>
                            <option value="14"> 31 - (31) เงินกู้พิเศษ - ซื้อบ้าน </option>
                            <option value="15"> 32 - (32) เงินกู้พิเศษ - ซื้อรถยนต์ </option>
                            <option value="16"> 36 - (36) เงินกู้พิเศษ - ซื้อบ้านสวัสดิการเจ้าหน้าที่ </option>
                            <option value="17"> 39 - (39) เงินกู้พิเศษ - หุ้นค้ำ(ชำระรายปี) </option>
                            <option value="18"> 3A - (3A) เงินกู้พิเศษ - (หุ้น เงินฝากค้ำ 240 งวด) </option>
                            <option value="19"> 3B - (3B) เงินกู้พิเศษ - บ้าน(อายุ 65) </option>
                            <option value="20"> 3C - (3C) เงินกู้พิเศษ - ซื้อบ้าน(คำนวณโอที) </option>
                            <option value="21"> 3D - (3D) เงินกู้พิเศษ - บ้าน(อายุ 65)(คำนวณโอที) </option>
                            <option value="22"> 3E - (3E) เงินกู้พิเศษ - ซื้อรถยนต์(คำนวณโอที) </option>
                            <option value="23"> 3M - (3M) โครงการเงินกู้พิเศษ - เคหะ(25 ปี)(34/62) </option>
                            <option value="24"> 45 - (45) เงินกู้สวัสดิการเจ้าหน้าที่ </option>
                            <option value="25"> 6L - (6L) เงินกู้สามัญ - ปกติ(คำนวณโอที) </option>
                            <option value="26"> 71 - (71) เงินกู้สามัญ-เงินรางวัลพิเศษปี 67 (4เท่า) (48/66) </option>
                            <option value="27"> 7G - (7G) เงินกู้สามัญ - หุ้นค้ำ(ชำระรายปี สมาชิกสมทบ) </option>
                            <option value="28"> 81 - (สค) เงินกู้สามัญโครงการ 7 ล้าน </option>
                            <option value="29"> 82 - (82) เงินกู้สามัญ - เจ็ดล้าน(คำนวณโอที)(40/65) </option>
                            <option value="30"> 83 - (83) เงินกู้สามัญ - 3 เท่าของเงินเดือน (39/65) </option>
                            <option value="31"> 84 - (84) เงินกู้สามัญ - เงินสงเคราะห์ถึงแก่กรรม(41/65) </option>
                            <option value="32"> 85 - (สค) เงินกู้สามัญปันผล </option>
                            <option value="33"> 86 - (86) เงินกู้สามัญเพือการศีกษาบุตร </option>
                            <option value="34"> 89 - (89) เงินกู้สามัญ - เงินรางวัลพิเศษปี2567(44/66) </option>
                            <option value="35"> 99 - (99) เงินกู้เพื่อใช้ในทดสอบการสร้างผลิตภัณฑ์ใหม่ </option>
                            <option value="36"> 9V - (9V) เงินกู้สามัญ - ทดสอบ </option>
                        </select>
                    </div>

                    <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                        <label class="form-label my-element" for="">สังกัด</label>
                        <select class="form-select" name="" id="" style="text-align:left;">
                            <option value="1">กรุณาเลือก</option>
                            <option value="2">1</option>
                            <option value="3">2</option>
                            <option value="4">3</option>
                        </select>
                    </div>

                    <div class="col-xl-2 col-md-4 col-sm-6 d-flex flex-column">
                        <label class="form-label my-element" style="margin-top: 25px;"></label>
                        <select class="form-select" name="" id="" style="text-align:left;">
                            <option value="1">รออนุมัติ</option>
                            <option value="2">อนุมัติออกเลขสัญญา</option>
                            <option value="3">อนุมัติและจ่าย</option>
                        </select>
                    </div>

                    <div class="col-xl-2 col-md-4 col-sm-6 d-flex flex-column">
                        <div class="form-check" style="margin-top: 35px;">
                            <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault" @bind="item.coop_id">
                            <label class="form-check-label" for="flexCheckDefault">ระบุวันที่จ่ายเงินกู้</label>
                        </div>
                    </div>

                    <div class="col-xl-2 col-md-6 col-sm-6 d-flex flex-column">
                        <label class="form-label my-element">วันที่จ่าย</label>
                        <RadzenDatePicker @bind-Value=@payment_date Name="payment_date" DateFormat="dd/MM/yyyy" />
                    </div>

                    <h5>ข้อมูลประกอบการขอกู้</h5>
                    <div class="row">
                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element">วันเกิด</label>
                            <RadzenDatePicker @bind-Value=@birthday Name="birthday" DateFormat="dd/MM/yyyy" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element">วันเกษียณ</label>
                            <RadzenDatePicker @bind-Value=@retirement_date Name="retirement_date" DateFormat="dd/MM/yyyy" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element">เป็นสมาชิก</label>
                            <RadzenDatePicker @bind-Value=@member_date Name="member_date" DateFormat="dd/MM/yyyy" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element">วันเข้าทำงาน</label>
                            <RadzenDatePicker @bind-Value=@working_date Name="working_date" DateFormat="dd/MM/yyyy" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">ทุนเรือนหุ้น</label>
                            <input class="form-control" style="text-align: end; font-size: 16px;" placeholder="0.00"
                                Name="chq_amt" />
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" style="margin-top: 25px;">วัตถุประสงค์
                                สิทธิการกู้</label>
                            <select class="form-select" name="" id="" style="text-align:left;">
                                <option value="1">กรุณาเลือก</option>
                                <option value="2">A</option>
                                <option value="3">B</option>
                                <option value="4">C</option>
                            </select>
                        </div>

                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" style="margin-top: 25px;">เงื่อนไขอัตราดอกเบี้ย</label>
                            <select class="form-select" name="" id="" style="text-align:left;">
                                <option value="1">กรุณาเลือก</option>
                                <option value="2">A</option>
                                <option value="3">B</option>
                                <option value="4">C</option>
                            </select>
                        </div>

                        <div class="col-xl-2 col-md-4 col-sm-4 d-flex flex-column">
                            <div class="form-check" style="margin-top: 65px;">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">วงเงิน OD</label>
                            </div>
                        </div>

                        <div class="col-xl-2 col-md-4 col-sm-4 d-flex flex-column">
                            <div class="form-check" style="margin-top: 65px;">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">หุ้นรอเก็บ</label>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xl-3 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">สิทธิ์กู้ที่ได้</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-3 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">สิทธิกู้สุทธิ</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-3 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">ให้กู้</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-3 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">ดอกเบี้ยประมาณ</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xl-2 col-md-4 col-sm-4 d-flex flex-column">
                            <div class="form-check" style="margin-top: 45px;">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">กำหนดงวดเอง</label>
                            </div>
                        </div>

                        <div class="col-xl-2 col-md-4 col-sm-4 d-flex flex-column">
                            <div class="form-check" style="margin-top: 45px;">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">ขอส่งเกินงวดเกษียณ</label>
                            </div>
                        </div>

                        <div class="col-xl-2 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">ชำระงวด</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-3 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">จำนวนงวด</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-3 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">งวดสุดท้าย</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" style="margin-top: 25px;">ประเภทการส่ง</label>
                            <select class="form-select" name="" id="" style="text-align:left;">
                                <option value="1">ไม่มีการเรียกเก็บ</option>
                                <option value="2">ต้นเท่ากัน</option>
                                <option value="3">ต้น+ดอกเท่ากัน</option>
                                <option value="4">ส่งแต่ดอกเบี้ย</option>
                                <option value="5">อัตราก้าวหน้า</option>
                            </select>
                        </div>

                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" style="margin-top: 25px;">การชำระแบบ</label>
                            <select class="form-select" name="" id="" style="text-align:left;">
                                <option value="1">หักจากเงินเดือน</option>
                                <option value="2">หักจากบัญชีเงินฝาก</option>
                                <option value="3">บัญชีภายนอก</option>
                                <option value="4">ชำระเอง</option>
                                <option value="4">เงินปันผล</option>
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">เงินเดือน</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">ยอดหักจาก สก</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">ยอดหักอื่นๆ</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">เงินได้อื่นๆ</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">เงินได้คงเหลือ</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-4 col-md-6 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">เงินได้เหลือขั้นต่ำ</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" style="margin-top: 25px;">จ่ายเงินกู้เป็น</label>
                            <select class="form-select" name="" id="" style="text-align:left;">
                                <option value="1">เงินสด</option>
                                <option value="2">เช็คธนาคาร</option>
                                <option value="3">โอนธนาคาร</option>
                                <option value="4">โอนภายนอกสหกรณ์</option>
                                <option value="5">โอนภายในสหกรณ์</option>
                                <option value="6">เงินเดือน</option>
                                <option value="7">เงินรอจ่ายคืน</option>
                                <option value="8">เงินกู้แบ่งจ่าย</option>
                            </select>
                        </div>

                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" style="margin-top: 25px;">กรุณาเลือกธนาคาร</label>
                            <select class="form-select" name="" id="" style="text-align:left;">
                                <option value="1">กรุณาเลือกธนาคาร</option>
                                <option value="2">002-ธนาคารกรุงเทพ จำกัด (มหาชน)</option>
                                <option value="3">004-ธนาคารกสิกรไทย จำกัด (มหาชน)</option>
                                <option value="4">006-ธนาคารกรุงไทย จำกัด (มหาชน)</option>
                                <option value="5">011-ธนาคารทหารไทย จำกัด (มหาชน)</option>
                                <option value="6">014-ธนาคารไทยพานิชย์ จำกัด (มหาชน)</option>
                                <option value="7">025-ธนาคารกรุงศรีอยุธยา จำกัด (มหาชน)</option>
                                <option value="8">030-ธนาคารออมสิน</option>
                                <option value="9">033-ธนาคารอาคารสงเคราะห์</option>
                                <option value="10">034-ธนาคารเพื่อการเกษตรและสหกรณ์การเกษตร</option>
                                <option value="11">065-ธนาคารธนชาต</option>
                            </select>
                        </div>

                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" style="margin-top: 25px;" for="">สาขา</label>
                            <input class="form-control" />
                        </div>

                        <div class="col-xl-4 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">เลขที่บัญชี</label>
                            <input class="form-control" style="text-align: end;" placeholder="0.00" Name="chq_amt" />
                        </div>

                        <div class="col-xl-8 col-md-4 col-sm-6 d-flex flex-column">
                            <label class="form-label my-element" for="">หมายเหตุ</label>
                            <input class="form-control" />
                        </div>
                    </div>
                </div>
            }
        }
    </div>
</div>

<div class="card mt-4" hidden="@(currentStep == 1 ||currentStep == 2)">
    <div class="row mt-2"
        style="margin-left: calc(var(--bs-gutter-x) * .5);margin-right: calc(var(--bs-gutter-x) * .5);margin-bottom: 10px;">
        <RadzenTabs @bind-SelectedIndex=@selectedIndex>
            <Tabs>
                <RadzenTabsItem Text="หลักประกัน">
                    <RadzenDataGrid Data="@dataaccDetails" TItem="Models.AccountDetails" ColumnWidth="200px"
                        AllowFiltering="true" FilterPopupRenderMode="PopupRenderMode.OnDemand"
                        FilterMode="FilterMode.Advanced" IsLoading="@isLoadingModals" PageSize="10" AllowPaging="true"
                        AllowSorting="true" PagerHorizontalAlign="HorizontalAlign.Left" ShowPagingSummary="true">
                        <Columns>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ลำดับ" Property="prnc_no">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="หลักประกัน" Property="prnc_bal">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="เลขที่สมาชิก"
                                Property="prncslip_amt">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="รายละเอียด" Property="prnc_date">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="สิทธิค้ำคงเหลือ"
                                Property="prncdue_date">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ค้ำประกัน"
                                Property="calint_from">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="%	" Property="calint_to">
                            </RadzenDataGridColumn>
                        </Columns>
                    </RadzenDataGrid>
                </RadzenTabsItem>
            </Tabs>
        </RadzenTabs>
    </div>
</div>

<div class="card mt-4" hidden="@(currentStep == 1 ||currentStep == 2)">
    <div class="row mt-2"
        style="margin-left: calc(var(--bs-gutter-x) * .5);margin-right: calc(var(--bs-gutter-x) * .5);margin-bottom: 10px;">
        <RadzenTabs @bind-SelectedIndex=@selectedIndex>
            <Tabs>
                <RadzenTabsItem Text="หักชำระเงินกู้">
                    <RadzenDataGrid Data="@dataaccDetails" TItem="Models.AccountDetails" ColumnWidth="200px"
                        AllowFiltering="true" FilterPopupRenderMode="PopupRenderMode.OnDemand"
                        FilterMode="FilterMode.Advanced" IsLoading="@isLoadingModals" PageSize="10" AllowPaging="true"
                        AllowSorting="true" PagerHorizontalAlign="HorizontalAlign.Left" ShowPagingSummary="true">
                        <Columns>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ลำดับ" Property="prnc_no">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="เลขที่สัญญา" Property="prnc_bal">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ประเภท" Property="prncslip_amt">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ส่งแบบ" Property="prnc_date">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="วงเงินกู้"
                                Property="prncdue_date">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="งวด" Property="calint_from">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ชำระ/งวด" Property="calint_to">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="คงเหลือ" Property="intpay_amt">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ดอกเบี้ย" Property="taxpay_amt">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="%" Property="intslip_net">
                            </RadzenDataGridColumn>
                        </Columns>
                    </RadzenDataGrid>
                </RadzenTabsItem>
            </Tabs>
        </RadzenTabs>
    </div>
</div>

<div class="card mt-4" hidden="@(currentStep == 1 ||currentStep == 2 )">
    <div class="row mt-2"
        style="margin-left: calc(var(--bs-gutter-x) * .5);margin-right: calc(var(--bs-gutter-x) * .5);margin-bottom: 10px;">
        <RadzenTabs @bind-SelectedIndex=@selectedIndex>
            <Tabs>
                <RadzenTabsItem Text="หักอื่นๆ">
                    <RadzenDataGrid Data="@dataaccDetails" TItem="Models.AccountDetails" ColumnWidth="200px"
                        AllowFiltering="true" FilterPopupRenderMode="PopupRenderMode.OnDemand"
                        FilterMode="FilterMode.Advanced" IsLoading="@isLoadingModals" PageSize="10" AllowPaging="true"
                        AllowSorting="true" PagerHorizontalAlign="HorizontalAlign.Left" ShowPagingSummary="true">
                        <Columns>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ลำดับ" Property="prnc_no">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="รายการ" Property="prnc_bal">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="รายละเอียด"
                                Property="prncslip_amt">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ยอดหัก" Property="prnc_date">
                            </RadzenDataGridColumn>
                        </Columns>
                    </RadzenDataGrid>
                </RadzenTabsItem>
                <RadzenTabsItem Text="ประกันชีวิต">
                    <RadzenDataGrid Data="@dataaccDetails" TItem="Models.AccountDetails" ColumnWidth="200px"
                        AllowFiltering="true" FilterPopupRenderMode="PopupRenderMode.OnDemand"
                        FilterMode="FilterMode.Advanced" IsLoading="@isLoadingModals" PageSize="10" AllowPaging="true"
                        AllowSorting="true" PagerHorizontalAlign="HorizontalAlign.Left" ShowPagingSummary="true">
                        <Columns>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ลำดับ" Property="prnc_no">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="รายการ" Property="prnc_bal">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ทุนประกัน"
                                Property="prncslip_amt">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ยอดหัก" Property="prnc_date">
                            </RadzenDataGridColumn>
                        </Columns>
                    </RadzenDataGrid>
                </RadzenTabsItem>
                <RadzenTabsItem Text="เรียกเก็บ">
                    <RadzenDataGrid Data="@dataaccDetails" TItem="Models.AccountDetails" ColumnWidth="200px"
                        AllowFiltering="true" FilterPopupRenderMode="PopupRenderMode.OnDemand"
                        FilterMode="FilterMode.Advanced" IsLoading="@isLoadingModals" PageSize="10" AllowPaging="true"
                        AllowSorting="true" PagerHorizontalAlign="HorizontalAlign.Left" ShowPagingSummary="true">
                        <Columns>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="รายละเอียด" Property="prnc_no">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="งวด" Property="prnc_bal">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ชำระต้น" Property="prncslip_amt">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="ชำระ ด/บ" Property="prnc_date">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="รวมชำระ" Property="prncdue_date">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="วันเริ่มคิดด/บถึง"
                                Property="calint_from">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="คงเหลือ" Property="calint_to">
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="Models.AccountDetails" Title="สถานะ" Property="intpay_amt">
                            </RadzenDataGridColumn>
                        </Columns>
                    </RadzenDataGrid>
                </RadzenTabsItem>
            </Tabs>
        </RadzenTabs>
    </div>
</div>


@code {
    int selectedIndex = 0;
    public IEnumerable<Models.AccountDetails> dataaccDetails { get; set; }
    private bool isLoadingModals;
    RadzenUpload upload;
    bool cancelUpload = false;

    void OnProgress(UploadProgressArgs args, string name)
    {
        Console.WriteLine($"{args.Progress}% '{name}' / {args.Loaded} of {args.Total} bytes.");

        if (args.Progress == 100)
        {
            foreach (var file in args.Files)
            {
                Console.WriteLine($"Uploaded: {file.Name} / {file.Size} bytes");
            }
        }
    }
}
